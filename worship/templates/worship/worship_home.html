{% extends 'core/base.html' %}
{% block content %}
<div class="container text-center" x-data="{ query: '', results: {} }">
  <p class="fs-1">Departamento de Música</p>
  
  <!-- Search input -->
  <div class="d-flex justify-content-center">
      <div class="input-group input-group-lg">
          <input type="text" class="form-control" placeholder="Busca uma canção..."
                 x-model="query"
                 x-on:input.debounce.300ms="
                     fetch('{% url 'worship:song-search' %}?q=' + encodeURIComponent(query))
                         .then(response => response.json())
                         .then(data => results = data)
                 ">
      </div>
  </div>

  <!-- Responsive Results Display -->
  <div class="mt-4 row">
      <!-- Results by Title and Artist (Left Column) -->
      <div class="col-lg-6 mb-4">
          <!-- Results by Title -->
          <div class="result-category" x-show="results.title_matches && results.title_matches.length > 0">
              <p class="fs-3">Resultados por Título</p>
              <table class="table table-striped">
                  <thead>
                      <tr>
                          <th scope="col">Título</th>
                          <th scope="col">Artista</th>
                      </tr>
                  </thead>
                  <tbody>
                      <template x-for="song in results.title_matches" :key="song.id">
                          <tr>
                              <td x-text="song.title"></td>
                              <td x-text="song.artist"></td>
                          </tr>
                      </template>
                  </tbody>
              </table>
          </div>

          <!-- Results by Artist -->
          <div class="result-category" x-show="results.artist_matches && results.artist_matches.length > 0">
              <p class="fs-3">Resultados por Artista</p>
              <table class="table table-striped">
                  <thead>
                      <tr>
                          <th scope="col">Título</th>
                          <th scope="col">Artista</th>
                      </tr>
                  </thead>
                  <tbody>
                      <template x-for="song in results.artist_matches" :key="song.id">
                          <tr>
                              <td x-text="song.title"></td>
                              <td x-text="song.artist"></td>
                          </tr>
                      </template>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- Results by Lyrics and Theme (Right Column) -->
      <div class="col-lg-6 mb-4">
          <!-- Results by Lyrics -->
          <div class="result-category" x-show="results.lyrics_matches && results.lyrics_matches.length > 0">
              <p class="fs-3">Resultados por Letra</p>
              <table class="table table-striped">
                  <thead>
                      <tr>
                          <th scope="col">Título</th>
                          <th scope="col">Artista</th>
                      </tr>
                  </thead>
                  <tbody>
                      <template x-for="song in results.lyrics_matches" :key="song.id">
                          <tr>
                              <td x-text="song.title"></td>
                              <td x-text="song.artist"></td>
                          </tr>
                      </template>
                  </tbody>
              </table>
          </div>

          <!-- Results by Theme -->
          <div class="result-category" x-show="results.theme_matches && results.theme_matches.length > 0">
              <p class="fs-3">Resultados por Tema</p>
              <table class="table table-striped">
                  <thead>
                      <tr>
                          <th scope="col">Título</th>
                          <th scope="col">Artista</th>
                      </tr>
                  </thead>
                  <tbody>
                      <template x-for="song in results.theme_matches" :key="song.id">
                          <tr>
                              <td x-text="song.title"></td>
                              <td x-text="song.artist"></td>
                          </tr>
                      </template>
                  </tbody>
              </table>
          </div>
      </div>
  </div>
</div>
{% endblock %}
