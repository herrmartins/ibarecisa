{% extends 'core/base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/treasury.css' %}">
<div class="container py-3">
  <div class="text-center mb-3">
    <p class="fs-3 fw-light mb-0">Tesouraria</p>
  </div>

 <!-- Cards de Estatísticas -->
 <div class="row g-3 mb-4 justify-content-center" style="max-width: 1200px; margin: 0 auto;">
   <div class="col-12 col-sm-6 col-lg-4 col-xl-2">
     <div class="p-3 bg-success text-white rounded text-center fw-bold stat-card">
       <div class="mb-2">Saldo Anterior</div>
       <img width="28" height="28" src="{% static 'img/book-open.svg' %}" alt="" class="mb-2">
       <div class="h4 fw-light">{{ previous_month_account_balance }}</div>
     </div>
   </div>
   <div class="col-12 col-sm-6 col-lg-4 col-xl-2">
     <div class="p-3 bg-primary text-white rounded text-center fw-bold stat-card">
       <div class="mb-2" id="saldoLabel">Saldo Corrente</div>
       <img width="28" height="28" src="{% static 'img/dollar-sign.svg' %}" alt="" class="mb-2">
       <div class="h4 fw-light" id="currentBalance"></div>
     </div>
   </div>
   <div class="col-12 col-sm-6 col-lg-4 col-xl-2">
     <div class="p-3 bg-secondary text-white rounded text-center fw-bold stat-card">
       <div class="mb-2">Resultado Mensal</div>
       <img width="28" height="28" src="{% static 'img/calendar.svg' %}" alt="" class="mb-2">
       <div class="h4 fw-light" id="currentAnawareBalance"></div>
     </div>
   </div>
   <div class="col-12 col-sm-6 col-lg-4 col-xl-2">
     <div class="p-3 bg-info text-white rounded text-center fw-bold stat-card">
       <div class="mb-2">Entradas</div>
       <img width="28" height="28" src="{% static 'img/arrow-left-circle.svg' %}" alt="" class="mb-2">
       <div class="h4 fw-light" id="positive_transactions"></div>
     </div>
   </div>
   <div class="col-12 col-sm-6 col-lg-4 col-xl-2">
     <div class="p-3 bg-danger text-white rounded text-center fw-bold stat-card">
       <div class="mb-2">Saídas</div>
       <img width="28" height="28" src="{% static 'img/arrow-right-circle.svg' %}" alt="" class="mb-2">
       <div class="h4 fw-light" id="negative_transactions"></div>
     </div>
   </div>
 </div>

  <div class="ai-hero p-3 mb-3">
    <div class="row justify-content-center align-items-center g-2">
      <div class="col-auto">
        <button id="prevButton" class="btn btn-outline-light pill">Anterior</button>
      </div>
      <div class="col-auto">
        <select id="yearSelect" class="form-select">
          {% for y in year_list %}
          <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-auto">
        <select id="monthSelect" class="form-select">
          <option value="1">Janeiro</option>
          <option value="2">Fevereiro</option>
          <option value="3">Março</option>
          <option value="4">Abril</option>
          <option value="5">Maio</option>
          <option value="6">Junho</option>
          <option value="7">Julho</option>
          <option value="8">Agosto</option>
          <option value="9">Setembro</option>
          <option value="10">Outubro</option>
          <option value="11">Novembro</option>
          <option value="12">Dezembro</option>
        </select>
      </div>
      <div class="col-auto">
        <button id="nextButton" class="btn btn-outline-light pill">Próximo</button>
      </div>
    </div>
  </div>

  <div class="row g-4">
    {% if perms.treasury.add_transactionmodel %}
      <div class="col-md-4 col-12">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Adicionar Transação</h5>
          </div>
          <div class="card-body">
            <div id="transactionError" class="alert alert-danger" style="display: none;" role="alert">
              <strong>Erro:</strong> <span id="errorMessage"></span>
            </div>
            {% include 'treasury/transaction_form_chunck.html' with show_title=False %}
          </div>
        </div>
      </div>
    {% endif %}
    <div class="{% if perms.treasury.add_transactionmodel %}col-md-8{% else %}col-12{% endif %}">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Transações do Mês</h5>
        </div>
        <div class="card-body" id="transactions_list">
          <div class="table-responsive">
            <table class="table" id="transactionsTable">
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Descrição</th>
                  <th>Valor</th>
                  <th>Saldo</th>
                  <th>Editar</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
            <p id="noTransactionsMessage" class="text-muted text-center" style="display:none;">Não há transações para este mês...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="module" src="{% static 'js/load_transactions.js' %}"></script>
<script type="module" src="{% static 'js/add_transaction.js' %}?v={{ request.META.HTTP_DATE|default:'20240914' }}"></script>
<script type="module" src="{% static 'js/get_transactions.js' %}"></script>
<script type="module" src="{% static 'js/navigation.js' %}"></script>
{% endblock %}
