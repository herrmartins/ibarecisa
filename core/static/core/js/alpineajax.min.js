(()=>{var _={headers:{},mergeStrategy:"replace",transitions:!1,mapDelimiter:":"},F=()=>{console.error(`You can't use the "morph" merge without first installing the Alpine "morph" plugin here: https://alpinejs.dev/plugins/morph`)};function b(e){e.morph&&(F=e.morph),e.addInitSelector(()=>`[${e.prefixed("target")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.push")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.replace")}]`),e.directive("target",(a,{value:s,modifiers:t,expression:n},{evaluateLater:u,effect:l})=>{let d=c=>{a._ajax_target=a._ajax_target||{};let h={ids:C(a,c),sync:!0,focus:!t.includes("nofocus"),history:t.includes("push")?"push":t.includes("replace")?"replace":!1},o=t.filter(m=>m==="error"||parseInt(m));o=o.length?o:["xxx"],o.forEach(m=>{m.charAt(0)==="3"&&(m="3xx"),a._ajax_target[m]=h})};if(s==="dynamic"){let c=u(n);l(()=>c(d))}else d(n)}),e.directive("headers",(a,{expression:s},{evaluateLater:t,effect:n})=>{let u=t(s||"{}");n(()=>{u(l=>{a._ajax_headers=l})})}),e.addInitSelector(()=>`[${e.prefixed("merge")}]`),e.directive("merge",(a,{value:s,modifiers:t,expression:n},{evaluateLater:u,effect:l})=>{let d=c=>{a._ajax_strategy=c,a._ajax_transition=_.transitions||t.includes("transition")};if(s==="dynamic"){let c=u(n);l(()=>c(d))}else d(n)}),e.magic("ajax",a=>async(s,t={})=>{let n={el:a,target:{xxx:{ids:C(a,t.targets||t.target),sync:!!t.sync,history:"history"in t?t.history:!1,focus:"focus"in t?t.focus:!0}},headers:t.headers||{}},u=t.method?t.method.toUpperCase():"GET",l=t.body;return E(n,s,u,l)});let r=!1;e.ajax={start(){r||(document.addEventListener("submit",I),document.addEventListener("click",D),window.addEventListener("popstate",T),r=!0)},stop(){document.removeEventListener("submit",I),document.removeEventListener("click",D),window.removeEventListener("popstate",T),r=!1}},e.ajax.start()}b.configure=e=>(_=Object.assign(_,e),b);var $=b;function T(e){!e.state||!e.state.__ajax||window.location.reload(!0)}async function D(e){if(e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=e?.target.closest("a[href]:not([download]):not([noajax])");if(!r||!r._ajax_target||r.isContentEditable||r.origin!==window.location.origin||r.getAttribute("href").startsWith("#")||M(r,window.location)&&r.hash)return;e.preventDefault(),e.stopImmediatePropagation();let a={el:r,target:r._ajax_target,headers:r._ajax_headers||{}},s=r.getAttribute("href");try{return await E(a,s)}catch(t){if(t.name==="RenderError"){console.warn(t.message),window.location.href=r.href;return}throw t}}async function I(e){if(e.defaultPrevented)return;let r=e.target,a=e.submitter,s=(a?.getAttribute("formmethod")||r.getAttribute("method")||"GET").toUpperCase();if(!r||!r._ajax_target||s==="DIALOG"||a?.hasAttribute("formnoajax")||a?.hasAttribute("formtarget")||r.hasAttribute("noajax")||r.hasAttribute("target"))return;e.preventDefault(),e.stopImmediatePropagation();let t={el:r,target:r._ajax_target,headers:r._ajax_headers||{}},n=new FormData(r),u=r.getAttribute("enctype"),l=r.getAttribute("action");a&&(u=a.getAttribute("formenctype")||u,l=a.getAttribute("formaction")||l,a.name&&n.append(a.name,a.value));try{return await G(a,()=>E(t,l,s,n,u))}catch(d){if(d.name==="RenderError"){console.warn(d.message),r.setAttribute("noajax","true"),r.requestSubmit(a);return}throw d}}async function G(e,r){if(!e)return await r();let a=t=>t.preventDefault();e.setAttribute("aria-disabled","true"),e.addEventListener("click",a);let s;try{s=await r()}finally{e.removeAttribute("aria-disabled"),e.removeEventListener("click",a)}return s}var p=new Map;async function E(e,r="",a="GET",s=null,t="application/x-www-form-urlencoded"){if(!f(e.el,"ajax:before"))return;let n=e.target.xxx,u=new AbortController,l=L(n,u),d=e.el.closest("[data-source]")?.dataset.source||window.location.href,c={action:r||d,method:a,body:s?N(s):null,enctype:t,referrer:d,signal:u.signal,headers:Object.assign({"X-Alpine-Request":!0,"X-Alpine-Target":l.map(i=>i._ajax_id).join(" ")},_.headers,e.headers)};f(e.el,"ajax:send",c),c.body&&(c.method==="GET"?(c.action=B(c.body,c.action),c.body=null):c.enctype!=="multipart/form-data"&&(c.body=P(c.body)));let h;a==="GET"&&p.has(c.action)?h=p.get(c.action):(h=fetch(c.action,c).then(async i=>{let x=await i.text(),y=document.createRange().createContextualFragment("<template>"+x+"</template>");return i.html=y.firstElementChild.content,i.raw=x,i}),p.set(c.action,h));let o;try{o=await h}catch(i){if(i.name!=="AbortError")throw i;return}if(o.ok?(o.redirected&&(f(e.el,"ajax:redirect",o),p.set(o.url,h),setTimeout(()=>{p.delete(o.url)},5)),f(e.el,"ajax:success",o)):f(e.el,"ajax:error",o),f(e.el,"ajax:sent",o),!o.html){l.forEach(i=>i._ajax_abort());return}let m=o.redirected?"3xx":o.status.toString(),O=[m,m.charAt(0)+"xx",o.ok?"xxx":"error","xxx"].find(i=>i in e.target);n=e.target[O],(!n.ids.flat().includes("_self")||!o.redirected||!M(new URL(o.url),window.location))&&(l.forEach(i=>i._ajax_abort()),l=L(n,u)),n.history&&K(n.history,o.url);let g=!n.focus,U=l.map(async i=>{if(i._ajax_id==="_none"||(i===document.documentElement&&(window.location.href=o.url),!document.body.contains(i)))return;let x=o.html.getElementById(i._ajax_id);if(!x){if(i._ajax_sync||!f(e.el,"ajax:missing",{target:i,response:o}))return;if(o.ok)return i.remove();throw new j(i,o.status)}let y=async()=>{if(i=await H(i,x),i){i.dataset.source=o.url,i._ajax_abort&&i._ajax_abort();let v=["[x-autofocus]","[autofocus]"];for(;!g&&v.length;){let S=v.shift();i.matches(S)&&(g=k(i)),g=g||Array.from(i.querySelectorAll(S)).some(q=>k(q))}}return f(i,"ajax:merged"),i};if(f(i,"ajax:merge",{strategy:i._ajax_strategy,content:x,merge:y}))return y()});p.delete(c.action);let A=await Promise.all(U);return f(e.el,"ajax:after",{response:o,render:A}),A}function L(e,r){let a=t=>(t._ajax_strategy=t._ajax_strategy||_.mergeStrategy,t._ajax_transition=t._ajax_transition&&document.startViewTransition,t._ajax_abort&&t._ajax_abort(),t.querySelectorAll("[aria-busy]").forEach(n=>{n._ajax_abort&&n._ajax_abort()}),t.setAttribute("aria-busy","true"),t._ajax_abort=()=>{t.removeAttribute("aria-busy"),r.abort()},t),s=e.ids.map(t=>{let n=t[0],u=["_self","_top","_none"].includes(n)?document.documentElement:document.getElementById(n);if(!u){console.warn(`Target [#${n}] was not found in current document.`);return}let l=a(u);return l._ajax_id=t[1],l}).filter(t=>t);if(e.sync){let t=e.ids.flat();document.querySelectorAll("[x-sync]").forEach(n=>{let u=n.getAttribute("id");if(!u)throw new w(n);if(t.includes(u))return;let l=a(n);l._ajax_id=u,l._ajax_sync=!0,s.push(l)})}return s}function N(e){if(e instanceof FormData)return e;if(e instanceof HTMLFormElement)return new FormData(e);let r=new FormData;for(let a in e)typeof e[a]=="object"?r.append(a,JSON.stringify(e[a])):r.append(a,e[a]);return r}function B(e,r){return r=new URL(r,document.baseURI),r.search=P(e).toString(),r.toString()}function P(e){let r=Array.from(e.entries()).filter(([a,s])=>!(s instanceof File));return new URLSearchParams(r)}async function H(e,r){let a={before(t,n){return t.before(...n.childNodes),t},replace(t,n){return t.replaceWith(n),n},update(t,n){return t.replaceChildren(...n.childNodes),t},prepend(t,n){return t.prepend(...n.childNodes),t},append(t,n){return t.append(...n.childNodes),t},after(t,n){return t.after(...n.childNodes),t},morph(t,n){return F(t,n),document.getElementById(n.getAttribute("id"))}};return e._ajax_transition?(await document.startViewTransition(()=>(e=a[e._ajax_strategy](e,r),Promise.resolve())).updateCallbackDone,e):a[e._ajax_strategy](e,r)}function k(e){return!e||!e.getClientRects().length?!1:(setTimeout(()=>{e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.focus()},0),!0)}function K(e,r){return{push:()=>window.history.pushState({__ajax:!0},"",r),replace:()=>window.history.replaceState({__ajax:!0},"",r)}[e]()}function C(e,r=null){let a=e.getAttribute("id"),s=[a];if(r&&(s=Array.isArray(r)?r:r.split(" ")),s=s.filter(t=>t).map(t=>{let n=t.split(_.mapDelimiter).map(u=>u||a);return n[1]=n[1]||n[0],n}),s.length===0)throw new w(e);return s}function f(e,r,a){return e.dispatchEvent(new CustomEvent(r,{detail:a,bubbles:!0,composed:!0,cancelable:!0}))}function M(e,r){return R(e.pathname)+e.search===R(r.pathname)+r.search}function R(e){return e.replace(/\/$/,"")}var w=class extends DOMException{constructor(r){let a=(r.outerHTML.match(/<[^>]+>/)??[])[0]??"[Element]";super(`${a} is missing an ID to target.`,"IDError")}},j=class extends DOMException{constructor(r,a){let s=r.getAttribute("id");super(`Target [#${s}] was not found in response with status [${a}].`,"RenderError")}};document.addEventListener("alpine:initializing",()=>{$(window.Alpine)});})();
